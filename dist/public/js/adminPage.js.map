{"version":3,"sources":["../../../public/js/adminPage.js"],"names":["requests","document","getElementById","token","JSON","parse","sessionStorage","getItem","alertBox","apiUrl","auth","approve","requestId","res","confirm","fetch","method","headers","myHeader","then","resp","json","data","message","window","location","href","disapprove","resolve","Headers","Authorization","output","result","forEach","request","requester_name","requester_email","status","date","id","innerHTML","catch","error","style","display"],"mappings":";;AAAA,IAAMA,WAAWC,SAASC,cAAT,CAAwB,eAAxB,CAAjB;AACA,IAAMC,QAAQC,KAAKC,KAAL,CAAWC,eAAeC,OAAf,CAAuB,OAAvB,CAAX,CAAd;AACA,IAAMC,WAAWP,SAASC,cAAT,CAAwB,WAAxB,CAAjB;AACA,IAAMO,SAAS,mBAAf;;AAEA,IAAIN,SAASA,MAAMO,IAAnB,EAAyB;AAAA,MAsDdC,OAtDc,GAsDvB,SAASA,OAAT,CAAiBC,SAAjB,EAA4B;AAC1B,QAAMC,MAAMC,QAAQ,eAAR,CAAZ;AACA,QAAID,GAAJ,EAAS;AACPE,iCAAyBH,SAAzB,eAA8C;AAC5CI,gBAAQ,KADoC;AAE5CC,iBAASC;AAFmC,OAA9C,EAIGC,IAJH,CAIQ;AAAA,eAAQC,KAAKC,IAAL,EAAR;AAAA,OAJR,EAKGF,IALH,CAKQ,UAACG,IAAD,EAAU;AACd,YAAIA,KAAKC,OAAL,KAAiB,EAArB,EAAyB;AACvBC,iBAAOC,QAAP,CAAgBC,IAAhB,GAAuB,YAAvB;AACD;AACF,OATH;AAUD;AACF,GApEsB;;AAAA,MAsEdC,UAtEc,GAsEvB,SAASA,UAAT,CAAoBf,SAApB,EAA+B;AAC7B,QAAMC,MAAMC,QAAQ,eAAR,CAAZ;AACA,QAAID,GAAJ,EAAS;AACPE,iCAAyBH,SAAzB,kBAAiD;AAC/CI,gBAAQ,KADuC;AAE/CC,iBAASC;AAFsC,OAAjD,EAIGC,IAJH,CAIQ;AAAA,eAAQC,KAAKC,IAAL,EAAR;AAAA,OAJR,EAKGF,IALH,CAKQ,UAACG,IAAD,EAAU;AACd,YAAIA,KAAKC,OAAL,KAAiB,EAArB,EAAyB;AACvBC,iBAAOC,QAAP,CAAgBC,IAAhB,GAAuB,YAAvB;AACD;AACF,OATH;AAUD;AACF,GApFsB;;AAAA,MAsFdE,OAtFc,GAsFvB,SAASA,OAAT,CAAiBhB,SAAjB,EAA4B;AAC1B,QAAMC,MAAMC,QAAQ,eAAR,CAAZ;AACA,QAAID,GAAJ,EAAS;AACPE,iCAAyBH,SAAzB,eAA8C;AAC5CI,gBAAQ,KADoC;AAE5CC,iBAASC;AAFmC,OAA9C,EAIGC,IAJH,CAIQ;AAAA,eAAQC,KAAKC,IAAL,EAAR;AAAA,OAJR,EAKGF,IALH,CAKQ,UAACG,IAAD,EAAU;AACd,YAAIA,KAAKC,OAAL,KAAiB,EAArB,EAAyB;AACvBC,iBAAOC,QAAP,CAAgBC,IAAhB,GAAuB,YAAvB;AACD;AACF,OATH;AAUD;AACF,GApGsB;;AACvB,MAAMR,WAAW,IAAIW,OAAJ,CAAY;AAC3BC,+BAAyB3B,MAAMA;AADJ,GAAZ,CAAjB;AAGAY,QAAMN,MAAN,EAAc;AACZQ,aAASC;AADG,GAAd,EAGGC,IAHH,CAGQ;AAAA,WAAON,IAAIQ,IAAJ,EAAP;AAAA,GAHR,EAIGF,IAJH,CAIQ,UAACG,IAAD,EAAU;AACd,QAAIS,SAAS,EAAb;AACAT,SAAKU,MAAL,CAAYC,OAAZ,CAAoB,UAACC,OAAD,EAAa;AAC/BH,qEAEkBG,QAAQC,cAF1B,uCAGkBD,QAAQE,eAH1B,gEAI2CF,QAAQG,MAJnD,qBAIyEH,QAAQG,MAJjF,8CAKkBH,QAAQI,IAL1B,uCAMkBJ,QAAQA,OAN1B,6FAQ8CA,QAAQK,EARtD,0GASiDL,QAAQK,EATzD,yGAU8CL,QAAQK,EAVtD;AAcD,KAfD;AAgBAvC,aAASwC,SAAT,GAAqBT,MAArB;AACD,GAvBH,EAwBGU,KAxBH,CAwBS,UAACC,KAAD,EAAW;AAChBlC,aAASgC,SAAT;AAsBAvC,aAASC,cAAT,CAAwB,eAAxB,EAAyCyC,KAAzC,CAA+CC,OAA/C,GAAyD,OAAzD;AACD,GAhDH;AAiGD,CArGD,MAqGO;AACLpC,WAASgC,SAAT;AAoBAvC,WAASC,cAAT,CAAwB,eAAxB,EAAyCyC,KAAzC,CAA+CC,OAA/C,GAAyD,OAAzD;AACD","file":"adminPage.js","sourcesContent":["const requests = document.getElementById('adminRequests');\r\nconst token = JSON.parse(sessionStorage.getItem('token'));\r\nconst alertBox = document.getElementById('alert-box');\r\nconst apiUrl = '/api/v1/requests/';\r\n\r\nif (token && token.auth) {\r\n  const myHeader = new Headers({\r\n    Authorization: `Bearer ${token.token}`,\r\n  });\r\n  fetch(apiUrl, {\r\n    headers: myHeader,\r\n  })\r\n    .then(res => res.json())\r\n    .then((data) => {\r\n      let output = '';\r\n      data.result.forEach((request) => {\r\n        output += `\r\n                <tr>\r\n                    <td>${request.requester_name}</td>\r\n                    <td>${request.requester_email}</td>\r\n                    <td><span class=\"label label-${request.status} tableClear\">${request.status}</span></td>\r\n                    <td>${request.date}</td>\r\n                    <td>${request.request}</td>\r\n                    <td>\r\n                        <a href=\"#\" onClick=approve(${request.id}); class=\"btn-sm btn-approve\">Approve</a>\r\n                        <a href=\"#\" onClick=disapprove(${request.id}); class=\"btn-sm btn-delete\">Disapprove</a>\r\n                        <a href=\"#\" onClick=resolve(${request.id}); class=\"btn-sm btn-resolve\">Resolve</a>\r\n                    </td>\r\n                </tr>\r\n        `;\r\n      });\r\n      requests.innerHTML = output;\r\n    })\r\n    .catch((error) => {\r\n      alertBox.innerHTML = `\r\n    <header>\r\n        <a class=\"brand\" href=\"#\">M-Tracker</a>\r\n        <nav class=\"nav-bar\">\r\n            <ul>\r\n                <li><a class=\"btn btn-default\" href=\"../sign-in.html\">Log in</a></li>\r\n            </ul>\r\n        </nav>\r\n    </header>\r\n    <div class=\"wrapper\" style=\"margin-top: 200px\">\r\n        <div class=\"alert\" id=\"alert-message\">\r\n            <p>\r\n                Oops! Sorry, Your session has ended, therefore You are not Authorized to view this page, <strong>kindly log in</strong>!!\r\n                <br>OR<br>\r\n                You are not an <strong>Admin.</strong>\r\n            </p>\r\n        </div>\r\n    </div>\r\n    <footer>\r\n        <p>&copy;2018 VeeqTor</p>\r\n    </footer>\r\n      `;\r\n      document.getElementById('alert-message').style.display = 'block';\r\n    });\r\n\r\n  function approve(requestId) {\r\n    const res = confirm('ARE YOU SURE?');\r\n    if (res) {\r\n      fetch(`api/v1/requests/${requestId}/approve`, {\r\n        method: 'PUT',\r\n        headers: myHeader,\r\n      })\r\n        .then(resp => resp.json())\r\n        .then((data) => {\r\n          if (data.message !== '') {\r\n            window.location.href = 'admin.html';\r\n          }\r\n        });\r\n    }\r\n  }\r\n\r\n  function disapprove(requestId) {\r\n    const res = confirm('ARE YOU SURE?');\r\n    if (res) {\r\n      fetch(`api/v1/requests/${requestId}/disapprove`, {\r\n        method: 'PUT',\r\n        headers: myHeader,\r\n      })\r\n        .then(resp => resp.json())\r\n        .then((data) => {\r\n          if (data.message !== '') {\r\n            window.location.href = 'admin.html';\r\n          }\r\n        });\r\n    }\r\n  }\r\n\r\n  function resolve(requestId) {\r\n    const res = confirm('ARE YOU SURE?');\r\n    if (res) {\r\n      fetch(`api/v1/requests/${requestId}/resolve`, {\r\n        method: 'PUT',\r\n        headers: myHeader,\r\n      })\r\n        .then(resp => resp.json())\r\n        .then((data) => {\r\n          if (data.message !== '') {\r\n            window.location.href = 'admin.html';\r\n          }\r\n        });\r\n    }\r\n  }\r\n} else {\r\n  alertBox.innerHTML = `\r\n    <header>\r\n        <a class=\"brand\" href=\"#\">M-Tracker</a>\r\n        <nav class=\"nav-bar\">\r\n            <ul>\r\n                <li><a class=\"btn btn-default\" href=\"../sign-in.html\">Log in</a></li>\r\n            </ul>\r\n        </nav>\r\n    </header>\r\n    <div class=\"wrapper\" style=\"margin-top: 200px\">\r\n        <div class=\"alert\" id=\"alert-message\">\r\n            <p>\r\n                Oops! Sorry, You do not have access to this page!!\r\n            </p>\r\n        </div>\r\n    </div>\r\n    <footer>\r\n        <p>&copy;2018 VeeqTor</p>\r\n    </footer>\r\n      `;\r\n  document.getElementById('alert-message').style.display = 'block';\r\n}\r\n"]}