{"version":3,"sources":["../../../public/js/adminPage.js"],"names":["requests","document","getElementById","token","JSON","parse","sessionStorage","getItem","alertBox","filter","displayTable","apiUrl","auth","approve","requestId","res","confirm","fetch","method","headers","myHeader","then","resp","json","data","message","window","location","href","disapprove","resolve","Headers","Authorization","output","result","forEach","request","requester_name","requester_email","status","date","id","innerHTML","catch","error","style","display","addEventListener","selectedValue","options","selectedIndex","value"],"mappings":"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","file":"adminPage.js","sourcesContent":["const requests = document.getElementById('adminRequests');\r\nconst token = JSON.parse(sessionStorage.getItem('token'));\r\nconst alertBox = document.getElementById('alert-box');\r\nconst filter = document.getElementById('filter');\r\n\r\nconst displayTable = (apiUrl) => {\r\n  if (token && token.auth) {\r\n    const myHeader = new Headers({\r\n      Authorization: `Bearer ${token.token}`,\r\n    });\r\n    fetch(apiUrl, {\r\n      headers: myHeader,\r\n    })\r\n      .then(res => res.json())\r\n      .then((data) => {\r\n        let output = '';\r\n        data.result.forEach((request) => {\r\n          output += `\r\n                <tr>\r\n                    <td>${request.requester_name}</td>\r\n                    <td>${request.requester_email}</td>\r\n                    <td><span class=\"label label-${request.status} tableClear\">${request.status}</span></td>\r\n                    <td>${request.date}</td>\r\n                    <td>${request.request}</td>\r\n                    <td>\r\n                        <a href=\"#\" onClick=approve(${request.id}); class=\"btn-sm btn-approve\">Approve</a>\r\n                        <a href=\"#\" onClick=disapprove(${request.id}); class=\"btn-sm btn-delete\">Disapprove</a>\r\n                        <a href=\"#\" onClick=resolve(${request.id}); class=\"btn-sm btn-resolve\">Resolve</a>\r\n                    </td>\r\n                </tr>\r\n        `;\r\n        });\r\n        requests.innerHTML = output;\r\n      })\r\n      .catch((error) => {\r\n        alertBox.innerHTML = `\r\n    <header>\r\n        <a class=\"brand\" href=\"#\">M-Tracker</a>\r\n        <nav class=\"nav-bar\">\r\n            <ul>\r\n                <li><a class=\"btn btn-default\" href=\"../sign-in.html\">Log in</a></li>\r\n            </ul>\r\n        </nav>\r\n    </header>\r\n    <div class=\"wrapper\" style=\"margin-top: 200px\">\r\n        <div class=\"alert\" id=\"alert-message\">\r\n            <p>\r\n                Oops! Sorry, Your session has ended, therefore You are not Authorized to view this page, <strong>kindly log in</strong>!!\r\n                <br>OR<br>\r\n                You are not an <strong>Admin.</strong>\r\n            </p>\r\n        </div>\r\n    </div>\r\n    <footer>\r\n        <p>&copy;2018 VeeqTor</p>\r\n    </footer>\r\n      `;\r\n        document.getElementById('alert-message').style.display = 'block';\r\n      });\r\n\r\n    function approve(requestId) {\r\n      const res = confirm('ARE YOU SURE?');\r\n      if (res) {\r\n        fetch(`api/v1/requests/${requestId}/approve`, {\r\n          method: 'PUT',\r\n          headers: myHeader,\r\n        })\r\n          .then(resp => resp.json())\r\n          .then((data) => {\r\n            if (data.message !== '') {\r\n              window.location.href = 'admin.html';\r\n            }\r\n          });\r\n      }\r\n    }\r\n\r\n    function disapprove(requestId) {\r\n      const res = confirm('ARE YOU SURE?');\r\n      if (res) {\r\n        fetch(`api/v1/requests/${requestId}/disapprove`, {\r\n          method: 'PUT',\r\n          headers: myHeader,\r\n        })\r\n          .then(resp => resp.json())\r\n          .then((data) => {\r\n            if (data.message !== '') {\r\n              window.location.href = 'admin.html';\r\n            }\r\n          });\r\n      }\r\n    }\r\n\r\n    function resolve(requestId) {\r\n      const res = confirm('ARE YOU SURE?');\r\n      if (res) {\r\n        fetch(`api/v1/requests/${requestId}/resolve`, {\r\n          method: 'PUT',\r\n          headers: myHeader,\r\n        })\r\n          .then(resp => resp.json())\r\n          .then((data) => {\r\n            if (data.message !== '') {\r\n              window.location.href = 'admin.html';\r\n            }\r\n          });\r\n      }\r\n    }\r\n  } else {\r\n    alertBox.innerHTML = `\r\n    <header>\r\n        <a class=\"brand\" href=\"#\">M-Tracker</a>\r\n        <nav class=\"nav-bar\">\r\n            <ul>\r\n                <li><a class=\"btn btn-default\" href=\"../sign-in.html\">Log in</a></li>\r\n            </ul>\r\n        </nav>\r\n    </header>\r\n    <div class=\"wrapper\" style=\"margin-top: 200px\">\r\n        <div class=\"alert\" id=\"alert-message\">\r\n            <p>\r\n                Oops! Sorry, You do not have access to this page!!\r\n            </p>\r\n        </div>\r\n    </div>\r\n    <footer>\r\n        <p>&copy;2018 VeeqTor</p>\r\n    </footer>\r\n      `;\r\n    document.getElementById('alert-message').style.display = 'block';\r\n  }\r\n};\r\n\r\ndisplayTable('/api/v1/requests/');\r\n\r\nfilter.addEventListener('change', () => {\r\n  const selectedValue = filter.options[filter.selectedIndex].value;\r\n  switch (selectedValue) {\r\n    case '1':\r\n      displayTable('/api/v1/requests/approved');\r\n      break;\r\n    case '2':\r\n      displayTable('/api/v1/requests/disapproved');\r\n      break;\r\n    case '3':\r\n      displayTable('/api/v1/requests/resolved');\r\n      break;\r\n    case '4':\r\n      displayTable('/api/v1/requests/pending');\r\n      break;\r\n    default:\r\n      displayTable('/api/v1/requests/');\r\n      break;\r\n  }\r\n});\r\n"]}