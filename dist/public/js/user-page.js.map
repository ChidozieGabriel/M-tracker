{"version":3,"sources":["../../../public/js/user-page.js"],"names":["requests","document","getElementById","token","JSON","parse","localStorage","getItem","apiUrl","createRequest","fetch","headers","Headers","Authorization","then","res","json","data","requestss","result","forEach","request","id","date","status","innerHTML","catch","console","error","addEventListener","e","preventDefault","apiUrl2","payload","name","value","email","dept","method","body","message","reset","log"],"mappings":";;AAAA,IAAMA,WAAWC,SAASC,cAAT,CAAwB,cAAxB,CAAjB;AACA,IAAMC,QAAQC,KAAKC,KAAL,CAAWC,aAAaC,OAAb,CAAqB,OAArB,CAAX,CAAd;AACA,IAAMC,SAAS,yBAAf;AACA,IAAMC,gBAAgBR,SAASC,cAAT,CAAwB,eAAxB,CAAtB;;AAGA,IAAIC,KAAJ,EAAW;AACTO,QAAMF,MAAN,EAAc;AACZG,aAAS,IAAIC,OAAJ,CAAY;AACnBC,iCAAyBV;AADN,KAAZ;AADG,GAAd,EAKGW,IALH,CAKQ;AAAA,WAAOC,IAAIC,IAAJ,EAAP;AAAA,GALR,EAMGF,IANH,CAMQ,UAACG,IAAD,EAAU;AACd;AACA,QAAIC,YAAY,EAAhB;AACAD,SAAKE,MAAL,CAAYC,OAAZ,CAAoB,UAACC,OAAD,EAAa;AAC/BH,2FAE2CG,QAAQC,EAFnD,gEAGeD,QAAQA,OAHvB,2DAIuCA,QAAQE,IAJ/C,4DAKqCF,QAAQG,MAL7C,UAKwDH,QAAQG,MALhE;AASD,KAVD;AAWAxB,aAASyB,SAAT,GAAqBP,SAArB;AACD,GArBH,EAsBGQ,KAtBH,CAsBS;AAAA,WAASC,QAAQC,KAAR,CAAcA,KAAd,CAAT;AAAA,GAtBT;;AAwBAnB,gBAAcoB,gBAAd,CAA+B,QAA/B,EAAyC,UAACC,CAAD,EAAO;AAC9CA,MAAEC,cAAF;AACA,QAAMC,UAAU,yBAAhB;AACA,QAAMC,UAAU;AACdC,YAAMjC,SAASC,cAAT,CAAwB,MAAxB,EAAgCiC,KADxB;AAEdC,aAAOnC,SAASC,cAAT,CAAwB,OAAxB,EAAiCiC,KAF1B;AAGdE,YAAMpC,SAASC,cAAT,CAAwB,MAAxB,EAAgCiC,KAHxB;AAIdd,eAASpB,SAASC,cAAT,CAAwB,SAAxB,EAAmCiC;AAJ9B,KAAhB;;AAOAzB,UAAMsB,OAAN,EAAe;AACbM,cAAQ,MADK;AAEbC,sBAAcN,QAAQC,IAAtB,eAAoCD,QAAQG,KAA5C,cAA0DH,QAAQI,IAAlE,iBAAkFJ,QAAQZ,OAF7E;AAGbV,eAAS,IAAIC,OAAJ,CAAY;AACnB,wBAAgB,mCADG;AAEnBC,mCAAyBV;AAFN,OAAZ;AAHI,KAAf,EAQGW,IARH,CAQQ;AAAA,aAAOC,IAAIC,IAAJ,EAAP;AAAA,KARR,EASGF,IATH,CASQ,UAACG,IAAD,EAAU;AACd,UAAIA,KAAKuB,OAAL,KAAiB,EAArB,EAAwB;AACtB/B,sBAAcgC,KAAd;AACAd,gBAAQe,GAAR,CAAYzB,KAAKuB,OAAjB;AACD;AACF,KAdH,EAeGd,KAfH,CAeS;AAAA,aAASC,QAAQC,KAAR,aAAwBA,KAAxB,CAAT;AAAA,KAfT;AAgBD,GA1BD;AA6BD,CAtDD,MAsDO;AACL3B,WAASC,cAAT,CAAwB,OAAxB,EAAiCuB,SAAjC;AAKD","file":"user-page.js","sourcesContent":["const requests = document.getElementById('userRequests');\r\nconst token = JSON.parse(localStorage.getItem('token'));\r\nconst apiUrl = '/api/v1/users/requests/';\r\nconst createRequest = document.getElementById('createRequest');\r\n\r\n\r\nif (token) {\r\n  fetch(apiUrl, {\r\n    headers: new Headers({\r\n      Authorization: `Bearer ${token}`,\r\n    }),\r\n  })\r\n    .then(res => res.json())\r\n    .then((data) => {\r\n      // console.log(data.result);\r\n      let requestss = '';\r\n      data.result.forEach((request) => {\r\n        requestss += `\r\n         <li>\r\n              <a href='user-view-details.html?id=${request.id}' title=\"Click to view details\">\r\n                  <p>${request.request}</p>\r\n                  <span class=\"request-date\">${request.date}</span>\r\n                  <span class=\"label label-${request.status}\">${request.status}</span>\r\n              </a>\r\n          </li>\r\n        `;\r\n      });\r\n      requests.innerHTML = requestss;\r\n    })\r\n    .catch(error => console.error(error));\r\n\r\n  createRequest.addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n    const apiUrl2 = '/api/v1/users/requests/';\r\n    const payload = {\r\n      name: document.getElementById('name').value,\r\n      email: document.getElementById('email').value,\r\n      dept: document.getElementById('dept').value,\r\n      request: document.getElementById('request').value,\r\n    };\r\n\r\n    fetch(apiUrl2, {\r\n      method: 'POST',\r\n      body: `name=${payload.name}&email=${payload.email}&dept=${payload.dept}&request=${payload.request}`,\r\n      headers: new Headers({\r\n        'Content-Type': 'application/x-www-form-urlencoded',\r\n        Authorization: `Bearer ${token}`,\r\n      }),\r\n    })\r\n      .then(res => res.json())\r\n      .then((data) => {\r\n        if (data.message !== ''){\r\n          createRequest.reset();\r\n          console.log(data.message);\r\n        }\r\n      })\r\n      .catch(error => console.error(`Error: ${error}`));\r\n  });\r\n\r\n\r\n} else {\r\n  document.getElementById('alert').innerHTML = `\r\n      <p>\r\n            Oops!! You do not have access to this page!!\r\n      </p>\r\n      `;\r\n}\r\n"]}