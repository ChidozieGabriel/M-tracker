{"version":3,"sources":["../../../public/js/create.js"],"names":["token","JSON","parse","sessionStorage","getItem","alertBox","document","getElementById","apiUrl","createRequest","auth","fetch","headers","Headers","Authorization","then","res","json","data","error","innerHTML","style","display","catch","addEventListener","e","preventDefault","payload","name","value","email","dept","request","method","body","message","window","location","href"],"mappings":";;AAAA,IAAMA,QAAQC,KAAKC,KAAL,CAAWC,eAAeC,OAAf,CAAuB,OAAvB,CAAX,CAAd;AACA,IAAMC,WAAWC,SAASC,cAAT,CAAwB,WAAxB,CAAjB;AACA,IAAMC,SAAS,yBAAf;AACA,IAAMC,gBAAgBH,SAASC,cAAT,CAAwB,eAAxB,CAAtB;;AAEA,IAAIP,SAASA,MAAMU,IAAnB,EAAyB;AACvBC,UAAMH,MAAN,EAAc;AACZI,iBAAS,IAAIC,OAAJ,CAAY;AACnBC,uCAAyBd,MAAMA;AADZ,SAAZ;AADG,KAAd,EAKGe,IALH,CAKQ;AAAA,eAAOC,IAAIC,IAAJ,EAAP;AAAA,KALR,EAMGF,IANH,CAMQ,UAACG,IAAD,EAAU;AACd,YAAIA,KAAKC,KAAT,EAAgB;AACdd,qBAASe,SAAT;AAoBAd,qBAASC,cAAT,CAAwB,eAAxB,EAAyCc,KAAzC,CAA+CC,OAA/C,GAAyD,OAAzD;AACD;AACF,KA9BH,EA+BGC,KA/BH,CA+BS;AAAA,eAASJ,KAAT;AAAA,KA/BT;;AAiCAV,kBAAce,gBAAd,CAA+B,QAA/B,EAAyC,UAACC,CAAD,EAAO;AAC9CA,UAAEC,cAAF;AACA,YAAMC,UAAU;AACdC,kBAAMtB,SAASC,cAAT,CAAwB,MAAxB,EAAgCsB,KADxB;AAEdC,mBAAOxB,SAASC,cAAT,CAAwB,OAAxB,EAAiCsB,KAF1B;AAGdE,kBAAMzB,SAASC,cAAT,CAAwB,MAAxB,EAAgCsB,KAHxB;AAIdG,qBAAS1B,SAASC,cAAT,CAAwB,SAAxB,EAAmCsB;AAJ9B,SAAhB;AAMAlB,cAAMH,MAAN,EAAc;AACZyB,oBAAQ,MADI;AAEZC,4BAAcP,QAAQC,IAAtB,eAAoCD,QAAQG,KAA5C,cAA0DH,QAAQI,IAAlE,iBAAkFJ,QAAQK,OAF9E;AAGZpB,qBAAS,IAAIC,OAAJ,CAAY;AACnB,gCAAgB,mCADG;AAEnBC,2CAAyBd,MAAMA;AAFZ,aAAZ;AAHG,SAAd,EAQGe,IARH,CAQQ;AAAA,mBAAOC,IAAIC,IAAJ,EAAP;AAAA,SARR,EASGF,IATH,CASQ,UAACG,IAAD,EAAU;AACd,gBAAIA,KAAKiB,OAAL,KAAiB,EAArB,EAAyB;AACvBC,uBAAOC,QAAP,CAAgBC,IAAhB,GAAuB,+BAAvB;AACD;AACF,SAbH,EAcGf,KAdH,CAcS,UAACJ,KAAD;AAAA,mBAAWA,KAAX;AAAA,SAdT;AAeD,KAvBD;AAwBD,CA1DD,MA0DO;AACLd,aAASe,SAAT;AAoBAd,aAASC,cAAT,CAAwB,eAAxB,EAAyCc,KAAzC,CAA+CC,OAA/C,GAAyD,OAAzD;AACD","file":"create.js","sourcesContent":["const token = JSON.parse(sessionStorage.getItem('token'));\r\nconst alertBox = document.getElementById('alert-box');\r\nconst apiUrl = '/api/v1/users/requests/';\r\nconst createRequest = document.getElementById('createRequest');\r\n\r\nif (token && token.auth) {\r\n  fetch(apiUrl, {\r\n    headers: new Headers({\r\n      Authorization: `Bearer ${token.token}`,\r\n    }),\r\n  })\r\n    .then(res => res.json())\r\n    .then((data) => {\r\n      if (data.error) {\r\n        alertBox.innerHTML = `\r\n    <header>\r\n        <a class=\"brand\" href=\"#\">M-Tracker</a>\r\n        <nav class=\"nav-bar\">\r\n            <ul>\r\n                <li><a class=\"btn btn-default\" href=\"../sign-in.html\">Log in</a></li>\r\n            </ul>\r\n        </nav>\r\n    </header>\r\n    <div class=\"wrapper\" style=\"margin-top: 200px\">\r\n        <div class=\"alert\" id=\"alert-message\">\r\n            <p>\r\n                Oops! Sorry, Your session has ended, therefore You are not Authorized to view this page, <strong>kindly log in!</strong>\r\n            </p>\r\n        </div>\r\n    </div>\r\n    <footer>\r\n        <p>&copy;2018 VeeqTor</p>\r\n    </footer>\r\n      `;\r\n        document.getElementById('alert-message').style.display = 'block';\r\n      }\r\n    })\r\n    .catch(error => error);\r\n\r\n  createRequest.addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n    const payload = {\r\n      name: document.getElementById('name').value,\r\n      email: document.getElementById('email').value,\r\n      dept: document.getElementById('dept').value,\r\n      request: document.getElementById('request').value,\r\n    };\r\n    fetch(apiUrl, {\r\n      method: 'POST',\r\n      body: `name=${payload.name}&email=${payload.email}&dept=${payload.dept}&request=${payload.request}`,\r\n      headers: new Headers({\r\n        'Content-Type': 'application/x-www-form-urlencoded',\r\n        Authorization: `Bearer ${token.token}`,\r\n      }),\r\n    })\r\n      .then(res => res.json())\r\n      .then((data) => {\r\n        if (data.message !== '') {\r\n          window.location.href = 'user.html?success=true&type=2';\r\n        }\r\n      })\r\n      .catch((error) => error);\r\n  });\r\n} else {\r\n  alertBox.innerHTML = `\r\n    <header>\r\n        <a class=\"brand\" href=\"#\">M-Tracker</a>\r\n        <nav class=\"nav-bar\">\r\n            <ul>\r\n                <li><a class=\"btn btn-default\" href=\"../sign-in.html\">Log in</a></li>\r\n            </ul>\r\n        </nav>\r\n    </header>\r\n    <div class=\"wrapper\" style=\"margin-top: 200px\">\r\n        <div class=\"alert\" id=\"alert-message\">\r\n            <p>\r\n                Oops! Sorry, You do not have access to this page!!\r\n            </p>\r\n        </div>\r\n    </div>\r\n    <footer>\r\n        <p>&copy;2018 VeeqTor</p>\r\n    </footer>\r\n      `;\r\n  document.getElementById('alert-message').style.display = 'block';\r\n}\r\n"]}