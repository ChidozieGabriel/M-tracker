{"version":3,"sources":["../../../public/js/edit.js"],"names":["url","URL","window","location","href","id","searchParams","get","editRequest","document","getElementById","apiUrl","apiUrl2","token","JSON","parse","sessionStorage","getItem","alertBox","myHeader","Headers","Authorization","auth","fetch","headers","then","res","json","data","error","innerHTML","style","display","catch","result","value","requester_name","requester_email","dept","request","addEventListener","e","preventDefault","payload","name","email","method","body","console","log","message"],"mappings":"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","file":"edit.js","sourcesContent":["const url = new URL(window.location.href);\r\nconst id = url.searchParams.get('id');\r\nconst editRequest = document.getElementById('edit');\r\nconst apiUrl = `/api/v1/users/requests/${id}`;\r\nconst apiUrl2 = '/api/v1/users/requests/';\r\nconst token = JSON.parse(sessionStorage.getItem('token'));\r\nconst alertBox = document.getElementById('alert-box');\r\nconst myHeader = new Headers({\r\n  Authorization: `Bearer ${token.token}`,\r\n});\r\n\r\nif (token && token.auth) {\r\n  fetch(apiUrl2, {\r\n    headers: myHeader,\r\n  })\r\n    .then(res => res.json())\r\n    .then((data) => {\r\n      if (data.error) {\r\n        alertBox.innerHTML = `\r\n    <header>\r\n        <a class=\"brand\" href=\"#\">M-Tracker</a>\r\n        <nav class=\"nav-bar\">\r\n            <ul>\r\n                <li><a class=\"btn btn-default\" href=\"../sign-in.html\">Log in</a></li>\r\n            </ul>\r\n        </nav>\r\n    </header>\r\n    <div class=\"wrapper\" style=\"margin-top: 200px\">\r\n        <div class=\"alert\" id=\"alert-message\">\r\n            <p>\r\n                Oops! Sorry, Your session has ended, therefore You are not Authorized to view this page, kindly log in!!\r\n            </p>\r\n        </div>\r\n    </div>\r\n    <footer>\r\n        <p>&copy;2018 VeeqTor</p>\r\n    </footer>\r\n      `;\r\n        document.getElementById('alert-message').style.display = 'block';\r\n      }\r\n    })\r\n    .catch(error => error);\r\n\r\n  fetch(apiUrl, {\r\n    headers: myHeader,\r\n  })\r\n    .then(res => res.json())\r\n    .then((result) => {\r\n      document.getElementById('name').value = result.result[0].requester_name;\r\n      document.getElementById('email').value = result.result[0].requester_email;\r\n      document.getElementById('dept').value = result.result[0].dept;\r\n      document.getElementById('request').value = result.result[0].request;\r\n    });\r\n\r\n  editRequest.addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n    const payload = {\r\n      name: document.getElementById('name').value,\r\n      email: document.getElementById('email').value,\r\n      dept: document.getElementById('dept').value,\r\n      request: document.getElementById('request').value,\r\n    };\r\n\r\n    fetch(apiUrl, {\r\n      method: 'PUT',\r\n      body: `name=${payload.name}&email=${payload.email}&dept=${payload.dept}&request=${payload.request}`,\r\n      headers: new Headers({\r\n        'Content-Type': 'application/x-www-form-urlencoded',\r\n        Authorization: `Bearer ${token.token}`,\r\n      }),\r\n    })\r\n      .then(res => res.json())\r\n      .then((data) => {\r\n        console.log(data);\r\n        if (data.message !== '') {\r\n          window.location.href = 'user.html?success=true&type=1';\r\n        }\r\n      })\r\n      .catch(error => console.error(`Error: ${error}`));\r\n  });\r\n} else {\r\n  alertBox.innerHTML = `\r\n    <header>\r\n        <a class=\"brand\" href=\"#\">M-Tracker</a>\r\n        <nav class=\"nav-bar\">\r\n            <ul>\r\n                <li><a class=\"btn btn-default\" href=\"../sign-in.html\">Log in</a></li>\r\n            </ul>\r\n        </nav>\r\n    </header>\r\n    <div class=\"wrapper\" style=\"margin-top: 200px\">\r\n        <div class=\"alert\" id=\"alert-message\">\r\n            <p>\r\n                Oops! Sorry, You do not have access to this page!!\r\n            </p>\r\n        </div>\r\n    </div>\r\n    <footer>\r\n        <p>&copy;2018 VeeqTor</p>\r\n    </footer>\r\n      `;\r\n  document.getElementById('alert-message').style.display = 'block';\r\n}\r\n"]}