{"version":3,"sources":["../../../public/js/adminPage.js"],"names":["requests","document","getElementById","token","JSON","parse","sessionStorage","getItem","alertBox","apiUrl","auth","approve","requestId","res","confirm","fetch","method","headers","myHeader","then","resp","json","data","message","window","location","href","disapprove","resolve","Headers","Authorization","output","result","forEach","request","requester_name","requester_email","status","date","id","innerHTML","catch","error","style","display"],"mappings":"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","file":"adminPage.js","sourcesContent":["'use strict';\n\nvar requests = document.getElementById('adminRequests');\nvar token = JSON.parse(sessionStorage.getItem('token'));\nvar alertBox = document.getElementById('alert-box');\nvar apiUrl = '/api/v1/requests/';\n\nif (token && token.auth) {\n  var approve = function approve(requestId) {\n    var res = confirm('ARE YOU SURE?');\n    if (res) {\n      fetch('api/v1/requests/' + requestId + '/approve', {\n        method: 'PUT',\n        headers: myHeader\n      }).then(function (resp) {\n        return resp.json();\n      }).then(function (data) {\n        if (data.message !== '') {\n          window.location.href = 'admin.html';\n        }\n      });\n    }\n  };\n\n  var disapprove = function disapprove(requestId) {\n    var res = confirm('ARE YOU SURE?');\n    if (res) {\n      fetch('api/v1/requests/' + requestId + '/disapprove', {\n        method: 'PUT',\n        headers: myHeader\n      }).then(function (resp) {\n        return resp.json();\n      }).then(function (data) {\n        if (data.message !== '') {\n          window.location.href = 'admin.html';\n        }\n      });\n    }\n  };\n\n  var resolve = function resolve(requestId) {\n    var res = confirm('ARE YOU SURE?');\n    if (res) {\n      fetch('api/v1/requests/' + requestId + '/resolve', {\n        method: 'PUT',\n        headers: myHeader\n      }).then(function (resp) {\n        return resp.json();\n      }).then(function (data) {\n        if (data.message !== '') {\n          window.location.href = 'admin.html';\n        }\n      });\n    }\n  };\n\n  var myHeader = new Headers({\n    Authorization: 'Bearer ' + token.token\n  });\n  fetch(apiUrl, {\n    headers: myHeader\n  }).then(function (res) {\n    return res.json();\n  }).then(function (data) {\n    var output = '';\n    data.result.forEach(function (request) {\n      output += '\\n                <tr>\\n                    <td>' + request.requester_name + '</td>\\n                    <td>' + request.requester_email + '</td>\\n                    <td><span class=\"label label-' + request.status + ' tableClear\">' + request.status + '</span></td>\\n                    <td>' + request.date + '</td>\\n                    <td>' + request.request + '</td>\\n                    <td>\\n                        <a href=\"#\" onClick=approve(' + request.id + '); class=\"btn-sm btn-approve\">Approve</a>\\n                        <a href=\"#\" onClick=disapprove(' + request.id + '); class=\"btn-sm btn-delete\">Disapprove</a>\\n                        <a href=\"#\" onClick=resolve(' + request.id + '); class=\"btn-sm btn-resolve\">Resolve</a>\\n                    </td>\\n                </tr>\\n        ';\n    });\n    requests.innerHTML = output;\n  }).catch(function (error) {\n    alertBox.innerHTML = '\\n    <header>\\n        <a class=\"brand\" href=\"#\">M-Tracker</a>\\n        <nav class=\"nav-bar\">\\n            <ul>\\n                <li><a class=\"btn btn-default\" href=\"../sign-in.html\">Log in</a></li>\\n            </ul>\\n        </nav>\\n    </header>\\n    <div class=\"wrapper\" style=\"margin-top: 200px\">\\n        <div class=\"alert\" id=\"alert-message\">\\n            <p>\\n                Oops! Sorry, Your session has ended, therefore You are not Authorized to view this page, <strong>kindly log in</strong>!!\\n                <br>OR<br>\\n                You are not an <strong>Admin.</strong>\\n            </p>\\n        </div>\\n    </div>\\n    <footer>\\n        <p>&copy;2018 VeeqTor</p>\\n    </footer>\\n      ';\n    document.getElementById('alert-message').style.display = 'block';\n  });\n} else {\n  alertBox.innerHTML = '\\n    <header>\\n        <a class=\"brand\" href=\"#\">M-Tracker</a>\\n        <nav class=\"nav-bar\">\\n            <ul>\\n                <li><a class=\"btn btn-default\" href=\"../sign-in.html\">Log in</a></li>\\n            </ul>\\n        </nav>\\n    </header>\\n    <div class=\"wrapper\" style=\"margin-top: 200px\">\\n        <div class=\"alert\" id=\"alert-message\">\\n            <p>\\n                Oops! Sorry, You do not have access to this page!!\\n            </p>\\n        </div>\\n    </div>\\n    <footer>\\n        <p>&copy;2018 VeeqTor</p>\\n    </footer>\\n      ';\n  document.getElementById('alert-message').style.display = 'block';\n}\n//# sourceMappingURL=adminPage.js.map"]}