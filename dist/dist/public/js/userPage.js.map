{"version":3,"sources":["../../../public/js/userPage.js"],"names":["requests","document","getElementById","alertBox","token","JSON","parse","sessionStorage","getItem","url","URL","window","location","href","successMessage","searchParams","get","successType","messageBox","innerHTML","style","display","setTimeout","myHeader","Headers","Authorization","apiUrl","auth","fetch","headers","then","res","json","data","output","result","length","count","forEach","request","requester_name","requester_email","status","date","id","catch","error","deleteData","requestId","confirm","method","resp","message"],"mappings":"AAAA;;AAEA,IAAIA,WAAWC,SAASC,cAAT,CAAwB,cAAxB,CAAf;AACA,IAAIC,WAAWF,SAASC,cAAT,CAAwB,WAAxB,CAAf;AACA,IAAIE,QAAQC,KAAKC,KAAL,CAAWC,eAAeC,OAAf,CAAuB,OAAvB,CAAX,CAAZ;;AAEA,IAAIC,MAAM,IAAIC,GAAJ,CAAQC,OAAOC,QAAP,CAAgBC,IAAxB,CAAV;AACA,IAAIC,iBAAiBL,IAAIM,YAAJ,CAAiBC,GAAjB,CAAqB,SAArB,CAArB;AACA,IAAIC,cAAcR,IAAIM,YAAJ,CAAiBC,GAAjB,CAAqB,MAArB,CAAlB;AACA,IAAIE,aAAajB,SAASC,cAAT,CAAwB,eAAxB,CAAjB;;AAEA,IAAIY,mBAAmB,MAAvB,EAA+B;AAC7B,UAAQG,WAAR;AACE,SAAK,GAAL;AACEC,iBAAWC,SAAX,GAAuB,6BAAvB;AACAD,iBAAWE,KAAX,CAAiBC,OAAjB,GAA2B,OAA3B;AACA;AACF,SAAK,GAAL;AACEH,iBAAWC,SAAX,GAAuB,2CAAvB;AACAD,iBAAWE,KAAX,CAAiBC,OAAjB,GAA2B,OAA3B;AACA;AACF,SAAK,GAAL;AACEH,iBAAWC,SAAX,GAAuB,sCAAvB;AACAD,iBAAWE,KAAX,CAAiBC,OAAjB,GAA2B,OAA3B;AAXJ;AAaAC,aAAW,YAAY;AACrBJ,eAAWE,KAAX,CAAiBC,OAAjB,GAA2B,MAA3B;AACD,GAFD,EAEG,IAFH;AAGD;;AAED,IAAIE,WAAW,IAAIC,OAAJ,CAAY;AACzBC,iBAAe,YAAYrB,MAAMA;AADR,CAAZ,CAAf;;AAIA,IAAIsB,SAAS,yBAAb;;AAEA,IAAItB,SAASA,MAAMuB,IAAnB,EAAyB;AACvBC,QAAMF,MAAN,EAAc;AACZG,aAASN;AADG,GAAd,EAEGO,IAFH,CAEQ,UAAUC,GAAV,EAAe;AACrB,WAAOA,IAAIC,IAAJ,EAAP;AACD,GAJD,EAIGF,IAJH,CAIQ,UAAUG,IAAV,EAAgB;AACtB,QAAIC,SAAS,EAAb;AACA,QAAID,KAAKE,MAAL,CAAYC,MAAZ,GAAqB,CAAzB,EAA4B;AAC1B,UAAIC,QAAQ,CAAZ;AACAJ,WAAKE,MAAL,CAAYG,OAAZ,CAAoB,UAAUC,OAAV,EAAmB;AACrCL,kBAAU,sDAAsDG,SAAS,CAA/D,IAAoE,iCAApE,GAAwGE,QAAQC,cAAhH,GAAiI,iCAAjI,GAAqKD,QAAQE,eAA7K,GAA+L,0DAA/L,GAA4PF,QAAQG,MAApQ,GAA6Q,eAA7Q,GAA+RH,QAAQG,MAAvS,GAAgT,wCAAhT,GAA2VH,QAAQI,IAAnW,GAA0W,8FAA1W,GAA2cJ,QAAQK,EAAnd,GAAwd,+FAAxd,GAA0jBL,QAAQK,EAAlkB,GAAukB,8GAAvkB,GAAwrBL,QAAQK,EAAhsB,GAAqsB,qGAA/sB;AACD,OAFD;AAGA5C,eAASmB,SAAT,GAAqBe,MAArB;AACD,KAND,MAMO;AACLA,eAAS,0GAAT;AACAlC,eAASmB,SAAT,GAAqBe,MAArB;AACD;AACF,GAhBD,EAgBGW,KAhBH,CAgBS,UAAUC,KAAV,EAAiB;AACxB3C,aAASgB,SAAT,GAAqB,inBAArB;AACAlB,aAASC,cAAT,CAAwB,eAAxB,EAAyCkB,KAAzC,CAA+CC,OAA/C,GAAyD,OAAzD;AACD,GAnBD;AAoBD,CArBD,MAqBO;AACLlB,WAASgB,SAAT,GAAqB,2iBAArB;AACAlB,WAASC,cAAT,CAAwB,eAAxB,EAAyCkB,KAAzC,CAA+CC,OAA/C,GAAyD,OAAzD;AACD;;AAED,SAAS0B,UAAT,CAAoBC,SAApB,EAA+B;AAC7B,MAAIjB,MAAMkB,QAAQ,eAAR,CAAV;AACA,MAAIlB,GAAJ,EAAS;AACPH,UAAM,2BAA2BoB,SAA3B,GAAuC,SAA7C,EAAwD;AACtDE,cAAQ,QAD8C;AAEtDrB,eAASN;AAF6C,KAAxD,EAGGO,IAHH,CAGQ,UAAUqB,IAAV,EAAgB;AACtB,aAAOA,KAAKnB,IAAL,EAAP;AACD,KALD,EAKGF,IALH,CAKQ,UAAUG,IAAV,EAAgB;AACtB,UAAIA,KAAKmB,OAAL,KAAiB,EAArB,EAAyB;AACvBzC,eAAOC,QAAP,CAAgBC,IAAhB,GAAuB,+BAAvB;AACD;AACF,KATD;AAUD;AACF;AACD","file":"userPage.js","sourcesContent":["'use strict';\n\nvar requests = document.getElementById('userRequests');\nvar alertBox = document.getElementById('alert-box');\nvar token = JSON.parse(sessionStorage.getItem('token'));\n\nvar url = new URL(window.location.href);\nvar successMessage = url.searchParams.get('success');\nvar successType = url.searchParams.get('type');\nvar messageBox = document.getElementById('alert-success');\n\nif (successMessage === 'true') {\n  switch (successType) {\n    case '1':\n      messageBox.innerHTML = '<p>Successfully updated</p>';\n      messageBox.style.display = 'block';\n      break;\n    case '2':\n      messageBox.innerHTML = '<p>Successfully created a new request</p>';\n      messageBox.style.display = 'block';\n      break;\n    case '3':\n      messageBox.innerHTML = '<p>Request delete was successful</p>';\n      messageBox.style.display = 'block';\n  }\n  setTimeout(function () {\n    messageBox.style.display = 'none';\n  }, 3000);\n}\n\nvar myHeader = new Headers({\n  Authorization: 'Bearer ' + token.token\n});\n\nvar apiUrl = '/api/v1/users/requests/';\n\nif (token && token.auth) {\n  fetch(apiUrl, {\n    headers: myHeader\n  }).then(function (res) {\n    return res.json();\n  }).then(function (data) {\n    var output = '';\n    if (data.result.length > 0) {\n      var count = 0;\n      data.result.forEach(function (request) {\n        output += '\\n                <tr>\\n                    <td>' + (count += 1) + '</td>\\n                    <td>' + request.requester_name + '</td>\\n                    <td>' + request.requester_email + '</td>\\n                    <td><span class=\"label label-' + request.status + ' tableClear\">' + request.status + '</span></td>\\n                    <td>' + request.date + '</td>\\n                    <td>\\n                        <a href=\"user-view-details.html?id=' + request.id + '\" class=\"btn-sm btn-primary\">View</a>\\n                        <a href=\"edit-request.html?id=' + request.id + '\" class=\"btn-sm btn-edit\">Edit</a>\\n                        <a href=\"javascript:void(0)\" onClick=deleteData(' + request.id + '); class=\"btn-sm btn-delete\">Delete</a>\\n                    </td>\\n                </tr>\\n        ';\n      });\n      requests.innerHTML = output;\n    } else {\n      output = '\\n        <div class=\"alert\" style=\"display: block\">\\n            <p>No requests yet</p>\\n        </div>';\n      requests.innerHTML = output;\n    }\n  }).catch(function (error) {\n    alertBox.innerHTML = '\\n    <header>\\n        <a class=\"brand\" href=\"#\">M-Tracker</a>\\n        <nav class=\"nav-bar\">\\n            <ul>\\n                <li><a class=\"btn btn-default\" href=\"../sign-in.html\">Log in</a></li>\\n            </ul>\\n        </nav>\\n    </header>\\n    <div class=\"wrapper\" style=\"margin-top: 200px\">\\n        <div class=\"alert\" id=\"alert-message\">\\n            <p>\\n                Oops! Sorry, Your session has ended, therefore You are not Authorized to view this page, <strong>kindly log in!</strong>\\n            </p>\\n        </div>\\n    </div>\\n    <footer>\\n        <p>&copy;2018 VeeqTor</p>\\n    </footer>\\n      ';\n    document.getElementById('alert-message').style.display = 'block';\n  });\n} else {\n  alertBox.innerHTML = '\\n    <header>\\n        <a class=\"brand\" href=\"#\">M-Tracker</a>\\n        <nav class=\"nav-bar\">\\n            <ul>\\n                <li><a class=\"btn btn-default\" href=\"../sign-in.html\">Log in</a></li>\\n            </ul>\\n        </nav>\\n    </header>\\n    <div class=\"wrapper\" style=\"margin-top: 200px\">\\n        <div class=\"alert\" id=\"alert-message\">\\n            <p>\\n                Oops! Sorry, You do not have access to this page!!\\n            </p>\\n        </div>\\n    </div>\\n    <footer>\\n        <p>&copy;2018 VeeqTor</p>\\n    </footer>\\n      ';\n  document.getElementById('alert-message').style.display = 'block';\n}\n\nfunction deleteData(requestId) {\n  var res = confirm('Are you sure?');\n  if (res) {\n    fetch('api/v1/users/requests/' + requestId + '/delete', {\n      method: 'DELETE',\n      headers: myHeader\n    }).then(function (resp) {\n      return resp.json();\n    }).then(function (data) {\n      if (data.message !== '') {\n        window.location.href = 'user.html?success=true&type=3';\n      }\n    });\n  }\n}\n//# sourceMappingURL=userPage.js.map"]}