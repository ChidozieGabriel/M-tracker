{"version":3,"sources":["../../../public/js/edit.js"],"names":["url","URL","window","location","href","id","searchParams","get","editRequest","document","getElementById","apiUrl","apiUrl2","token","JSON","parse","sessionStorage","getItem","alertBox","messageBox","myHeader","Headers","Authorization","auth","fetch","headers","then","res","json","data","error","innerHTML","style","display","catch","result","value","requester_name","requester_email","dept","request","addEventListener","e","preventDefault","payload","name","email","method","body","setTimeout","message","console"],"mappings":"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","file":"edit.js","sourcesContent":["'use strict';\r\n\r\nvar url = new URL(window.location.href);\r\nvar id = url.searchParams.get('id');\r\nvar editRequest = document.getElementById('edit');\r\nvar apiUrl = '/api/v1/users/requests/' + id;\r\nvar apiUrl2 = '/api/v1/users/requests/';\r\nvar token = JSON.parse(sessionStorage.getItem('token'));\r\nvar alertBox = document.getElementById('alert-box');\r\nvar messageBox = document.getElementById('alert-warning');\r\n\r\nvar myHeader = new Headers({\r\n  Authorization: 'Bearer ' + token.token\r\n});\r\n\r\nif (token && token.auth) {\r\n  fetch(apiUrl2, {\r\n    headers: myHeader\r\n  }).then(function (res) {\r\n    return res.json();\r\n  }).then(function (data) {\r\n    if (data.error) {\r\n      alertBox.innerHTML = '\\n    <header>\\n        <a class=\"brand\" href=\"#\">M-Tracker</a>\\n        <nav class=\"nav-bar\">\\n            <ul>\\n                <li><a class=\"btn btn-default\" href=\"../sign-in.html\">Log in</a></li>\\n            </ul>\\n        </nav>\\n    </header>\\n    <div class=\"wrapper\" style=\"margin-top: 200px\">\\n        <div class=\"alert\" id=\"alert-message\">\\n            <p>\\n                Oops! Sorry, Your session has ended, therefore You are not Authorized to view this page, kindly log in!!\\n            </p>\\n        </div>\\n    </div>\\n    <footer>\\n        <p>&copy;2018 VeeqTor</p>\\n    </footer>\\n      ';\r\n      document.getElementById('alert-message').style.display = 'block';\r\n    }\r\n  }).catch(function (error) {\r\n    return error;\r\n  });\r\n\r\n  fetch(apiUrl, {\r\n    headers: myHeader\r\n  }).then(function (res) {\r\n    return res.json();\r\n  }).then(function (result) {\r\n    document.getElementById('name').value = result.result[0].requester_name;\r\n    document.getElementById('email').value = result.result[0].requester_email;\r\n    document.getElementById('dept').value = result.result[0].dept;\r\n    document.getElementById('request').value = result.result[0].request;\r\n  });\r\n\r\n  editRequest.addEventListener('submit', function (e) {\r\n    e.preventDefault();\r\n    var payload = {\r\n      name: document.getElementById('name').value,\r\n      email: document.getElementById('email').value,\r\n      dept: document.getElementById('dept').value,\r\n      request: document.getElementById('request').value\r\n    };\r\n\r\n    fetch(apiUrl, {\r\n      method: 'PUT',\r\n      body: 'name=' + payload.name + '&email=' + payload.email + '&dept=' + payload.dept + '&request=' + payload.request,\r\n      headers: new Headers({\r\n        'Content-Type': 'application/x-www-form-urlencoded',\r\n        Authorization: 'Bearer ' + token.token\r\n      })\r\n    }).then(function (res) {\r\n      return res.json();\r\n    }).then(function (data) {\r\n      if (data.error) {\r\n        messageBox.innerHTML = '<p>' + data.error + '</p>';\r\n        messageBox.style.display = 'block';\r\n        setTimeout(function () {\r\n          messageBox.style.display = 'none';\r\n        }, 10000);\r\n      } else if (data.message !== '') {\r\n        window.location.href = 'user.html?success=true&type=1';\r\n      }\r\n    }).catch(function (error) {\r\n      return console.error('Error: ' + error);\r\n    });\r\n  });\r\n} else {\r\n  alertBox.innerHTML = '\\n    <header>\\n        <a class=\"brand\" href=\"#\">M-Tracker</a>\\n        <nav class=\"nav-bar\">\\n            <ul>\\n                <li><a class=\"btn btn-default\" href=\"../sign-in.html\">Log in</a></li>\\n            </ul>\\n        </nav>\\n    </header>\\n    <div class=\"wrapper\" style=\"margin-top: 200px\">\\n        <div class=\"alert\" id=\"alert-message\">\\n            <p>\\n                Oops! Sorry, You do not have access to this page!!\\n            </p>\\n        </div>\\n    </div>\\n    <footer>\\n        <p>&copy;2018 VeeqTor</p>\\n    </footer>\\n      ';\r\n  document.getElementById('alert-message').style.display = 'block';\r\n}\r\n//# sourceMappingURL=edit.js.map"]}