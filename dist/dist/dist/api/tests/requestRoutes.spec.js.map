{"version":3,"sources":["../../../api/tests/requestRoutes.spec.js"],"names":["_chai","require","_chai2","_interopRequireDefault","_userModel","_userModel2","_supertest","_supertest2","_chaiHttp","_chaiHttp2","_app","_app2","obj","__esModule","default","server","agent","Expect","expect","use","global","token","before","done","request","post","send","email","password","end","err","res","body","describe","it","get","set","Authorization","to","be","null","statusCode","equal","an","data1","name","date","dept","data","put","delete"],"mappings":"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","file":"requestRoutes.spec.js","sourcesContent":["'use strict';\r\n\r\nvar _chai = require('chai');\r\n\r\nvar _chai2 = _interopRequireDefault(_chai);\r\n\r\nvar _userModel = require('../models/userModel');\r\n\r\nvar _userModel2 = _interopRequireDefault(_userModel);\r\n\r\nvar _supertest = require('supertest');\r\n\r\nvar _supertest2 = _interopRequireDefault(_supertest);\r\n\r\nvar _chaiHttp = require('chai-http');\r\n\r\nvar _chaiHttp2 = _interopRequireDefault(_chaiHttp);\r\n\r\nvar _app = require('../../app');\r\n\r\nvar _app2 = _interopRequireDefault(_app);\r\n\r\nfunction _interopRequireDefault(obj) {\r\n  return obj && obj.__esModule ? obj : { default: obj };\r\n}\r\n\r\n// import { Pool } from 'pg';\r\n\r\nvar server = _supertest2.default.agent(_app2.default);\r\n\r\nvar Expect = _chai2.default.expect;\r\n\r\n_chai2.default.use(_chaiHttp2.default);\r\n\r\n// let token = null;\r\nglobal.token = null;\r\nbefore(function (done) {\r\n  _chai2.default.request(_app2.default).post('/api/v1/auth/login').send({\r\n    email: 'example@gmail.com',\r\n    password: '123456'\r\n  }).end(function (err, res) {\r\n    global.token = res.body.token;\r\n    done();\r\n  });\r\n});\r\n\r\n// afterEach((done) => {\r\n//   pool.query('DROP DATABASE \"testRunning\"', (err, results) => {\r\n//     if (err) {\r\n//       return err;\r\n//     }\r\n//     pool.end();\r\n//   });\r\n//   return done();\r\n// });\r\n\r\ndescribe('USER REQUEST CONTROLLER API ENDPOINT', function () {\r\n  it('Should list ALL requests on /user/request GET', function (done) {\r\n    _chai2.default.request(_app2.default).get('/api/v1/users/requests/').set({ Authorization: 'Bearer ' + global.token }).end(function (err, res) {\r\n      Expect(err).to.be.null;\r\n      Expect(res.statusCode).to.equal(200);\r\n      Expect(res).to.be.an('object');\r\n      done();\r\n    });\r\n  });\r\n\r\n  it('Should list ONE requests on /user/request/:requestId GET', function (done) {\r\n    _chai2.default.request(_app2.default).get('/api/v1/users/requests/1').set({ Authorization: 'Bearer ' + global.token }).end(function (err, res) {\r\n      Expect(res.statusCode).to.equal(200);\r\n      Expect(res).to.be.an('object');\r\n    });\r\n    done();\r\n  });\r\n\r\n  it('Should throw a 404 error when request is not found', function (done) {\r\n    _chai2.default.request(_app2.default).get('/api/v1/users/requests/1100').set({ Authorization: 'Bearer ' + global.token }).end(function (err, res) {\r\n      Expect(res.statusCode).to.equal(404);\r\n    });\r\n    done();\r\n  });\r\n\r\n  var data1 = {\r\n    name: 'Janet May',\r\n    email: 'janetMaye@yahoomail.com',\r\n    date: '2011-11-21',\r\n    dept: 'Engineering HQ',\r\n    request: 'Lorem ipsum owjjfndfnmnxnfj Lorem ipsum Lorem'\r\n  };\r\n\r\n  it('should create a SINGLE request user/requests/ POST', function (done) {\r\n\r\n    _chai2.default.request(_app2.default).post('/api/v1/users/requests').set({ Authorization: 'Bearer ' + global.token }).send(data1).end(function (err, res) {\r\n      Expect(res.statusCode).to.equal(201);\r\n    });\r\n    done();\r\n  });\r\n\r\n  it('should get an error when a bad request is sent on user/requests/  POST', function (done) {\r\n    _chai2.default.request(_app2.default).post('/api/v1/users/requests/').set({ Authorization: 'Bearer ' + global.token }).send(data1).end(function (err, res) {\r\n      Expect(res.statusCode).to.equal(400);\r\n    });\r\n    done();\r\n  });\r\n\r\n  it('should update a SINGLE request on user/requests/:requestId PUT', function (done) {\r\n    var data = {\r\n      name: 'Janet May',\r\n      email: 'janetMaye@yahoomail.com',\r\n      dept: 'Engineering HQ',\r\n      request: 'Lorem ipsum owjjfndfnmnxnfj Lorem ipsum Lorem'\r\n    };\r\n    _chai2.default.request(_app2.default).put('/api/v1/users/requests/1').set({ Authorization: 'Bearer ' + global.token }).send(data).end(function (err, res) {\r\n      Expect(res.statusCode).to.equal(200);\r\n      Expect(res).to.be.an('object');\r\n      Expect(res.body.data).to.be.an('object');\r\n    });\r\n    done();\r\n  });\r\n\r\n  it('should get an error when a request is not found on user/requests/:requestId  PUT', function (done) {\r\n    _chai2.default.request(_app2.default).put('/api/v1/users/requests/1100').set({ Authorization: 'Bearer ' + global.token }).end(function (err, res) {\r\n      Expect(res.statusCode).to.equal(404);\r\n    });\r\n    done();\r\n  });\r\n\r\n  //\r\n  it('should get an error when a request is not found on user/requests/:requestId  DELETE', function (done) {\r\n    _chai2.default.request(_app2.default).delete('/api/v1/users/requests/1110/delete').set({ Authorization: 'Bearer ' + global.token }).end(function (err, res) {\r\n      Expect(res.statusCode).to.equal(404);\r\n    });\r\n    done();\r\n  });\r\n\r\n  it('should delete a request on user/requests/:requestId  DELETE', function (done) {\r\n    _chai2.default.request(_app2.default).delete('/api/v1/users/requests/1/delete').set({ Authorization: 'Bearer ' + global.token }).end(function (err, res) {\r\n      Expect(res.statusCode).to.equal(200);\r\n    });\r\n    done();\r\n  });\r\n\r\n  it('should not grant access to none admin users', function (done) {\r\n    _chai2.default.request(_app2.default).get('/api/v1/requests/').set({ Authorization: 'Bearer ' + global.token }).end(function (err, res) {\r\n      Expect(res.statusCode).to.equal(403);\r\n    });\r\n    done();\r\n  });\r\n});\r\n//# sourceMappingURL=requestRoutes.spec.js.map\r\n//# sourceMappingURL=requestRoutes.spec.js.map"]}