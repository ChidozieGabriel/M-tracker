{"version":3,"sources":["../../../api/tests/requestRoutes.spec.js"],"names":["Expect","chai","expect","use","chaiHttp","global","token","before","done","request","app","post","send","email","password","end","err","res","body","after","describe","it","get","to","be","equal","statusCode","set","Authorization","an","data1","name","dept","data","put","delete"],"mappings":"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","file":"requestRoutes.spec.js","sourcesContent":["import chai from 'chai';\r\n\r\nimport chaiHttp from 'chai-http';\r\n\r\nimport app from '../../server';\r\n\r\nconst Expect = chai.expect;\r\n\r\nchai.use(chaiHttp);\r\nglobal.token = null;\r\nbefore((done) => {\r\n  chai.request(app)\r\n    .post('/api/v1/auth/login')\r\n    .send({\r\n      email: 'example@gmail.com',\r\n      password: '123456',\r\n    })\r\n    .end((err, res) => {\r\n      global.token = res.body.token;\r\n      done();\r\n    });\r\n});\r\n\r\nafter((done) => {\r\n  global.token = null;\r\n  done();\r\n});\r\n\r\ndescribe('SERVER', () => {\r\n  it('Should return 200 on root Endpoint  ', (done) => {\r\n    chai.request(app)\r\n      .get('/')\r\n      .end((err, res) => {\r\n        Expect(err)\r\n          .to\r\n          .be\r\n          .equal(null);\r\n        Expect(res.statusCode)\r\n          .to\r\n          .equal(200);\r\n        done();\r\n      });\r\n  });\r\n\r\n  it('Should return 404 when an invalid route is entered', (done) => {\r\n    chai.request(app)\r\n      .get('/open')\r\n      .end((err, res) => {\r\n        Expect(err)\r\n          .to\r\n          .be\r\n          .equal(null);\r\n        Expect(res.statusCode)\r\n          .to\r\n          .equal(404);\r\n        done();\r\n      });\r\n  });\r\n});\r\n\r\ndescribe('USER REQUEST CONTROLLER API ENDPOINT', () => {\r\n\r\n  it('Should list ALL requests on /user/request GET', (done) => {\r\n    chai.request(app)\r\n      .get('/api/v1/users/requests/')\r\n      .set({ Authorization: 'Bearer ' + global.token })\r\n      .end((err, res) => {\r\n        Expect(err)\r\n          .to\r\n          .be\r\n          .equal(null);\r\n        Expect(res.statusCode)\r\n          .to\r\n          .equal(200);\r\n        Expect(res)\r\n          .to\r\n          .be\r\n          .an('object');\r\n        done();\r\n      });\r\n  });\r\n\r\n  it('Should list ONE requests on /user/request/:requestId GET', (done) => {\r\n    chai.request(app)\r\n      .get('/api/v1/users/requests/1')\r\n      .set({ Authorization: 'Bearer ' + global.token })\r\n      .end((err, res) => {\r\n        Expect(res.statusCode)\r\n          .to\r\n          .equal(200);\r\n        Expect(res)\r\n          .to\r\n          .be\r\n          .an('object');\r\n      });\r\n    done();\r\n  });\r\n\r\n  it('Should throw a 404 error when request is not found', (done) => {\r\n    chai.request(app)\r\n      .get('/api/v1/users/requests/1100')\r\n      .set({ Authorization: 'Bearer ' + global.token })\r\n      .end((err, res) => {\r\n        Expect(res.statusCode)\r\n          .to\r\n          .equal(404);\r\n      });\r\n    done();\r\n  });\r\n\r\n  it('should create a SINGLE request user/requests/ POST', (done) => {\r\n    const data1 = {\r\n      name: 'Janet May',\r\n      dept: 'Engineering HQ',\r\n      request: 'Lorem ipsum owjjfndfnmnxnfj Lorem ipsum Lorem',\r\n    };\r\n    chai.request(app)\r\n      .post('/api/v1/users/requests')\r\n      .set({ Authorization: 'Bearer ' + global.token })\r\n      .send(data1)\r\n      .end((err, res) => {\r\n        Expect(res.statusCode)\r\n          .to\r\n          .equal(201);\r\n      });\r\n    done();\r\n  });\r\n\r\n  it('should update a SINGLE request on user/requests/:requestId PUT', (done) => {\r\n    const data = {\r\n      name: 'Janet May',\r\n      dept: 'Engineering HQ',\r\n      request: 'Lorem ipsum owjjfndfnmnxnfj Lorem ipsum Lorem',\r\n    };\r\n    chai.request(app)\r\n      .put('/api/v1/users/requests/3')\r\n      .set({ Authorization: 'Bearer ' + global.token })\r\n      .send(data)\r\n      .end((err, res) => {\r\n        Expect(res.statusCode)\r\n          .to\r\n          .equal(200);\r\n      });\r\n    done();\r\n  });\r\n\r\n  it('should get an error when a bad request is sent on user/requests/  POST', (done) => {\r\n    const data1 = {\r\n      name: '',\r\n      dept: 'Engineering HQ',\r\n      request: 'Lorem ipsum owjjfndfnmnxnfj Lorem ipsum Lorem',\r\n    };\r\n    chai.request(app)\r\n      .post('/api/v1/users/requests/')\r\n      .set({ Authorization: 'Bearer ' + global.token })\r\n      .send(data1)\r\n      .end((err, res) => {\r\n        Expect(res.statusCode)\r\n          .to\r\n          .equal(400);\r\n      });\r\n    done();\r\n  });\r\n\r\n  it('should get an error when a request is not found on user/requests/:requestId  PUT', (done) => {\r\n    const data = {\r\n      name: 'Janet May',\r\n      dept: 'Engineering HQ',\r\n      request: 'Lorem ipsum owjjfndfnmnxnfj Loremorem',\r\n    };\r\n    chai.request(app)\r\n      .put('/api/v1/users/requests/1100')\r\n      .send(data)\r\n      .set({ Authorization: 'Bearer ' + global.token })\r\n      .end((err, res) => {\r\n        Expect(res.statusCode)\r\n          .to\r\n          .equal(404);\r\n      });\r\n    done();\r\n  });\r\n\r\n  it('should get an error when a request is not found on user/requests/:requestId  DELETE', (done) => {\r\n    chai.request(app)\r\n      .delete('/api/v1/users/requests/1110/delete')\r\n      .set({ Authorization: 'Bearer ' + global.token })\r\n      .end((err, res) => {\r\n        Expect(res.statusCode)\r\n          .to\r\n          .equal(404);\r\n      });\r\n    done();\r\n  });\r\n\r\n  it('should delete a request on user/requests/:requestId  DELETE', (done) => {\r\n    chai.request(app)\r\n      .delete('/api/v1/users/requests/2/delete')\r\n      .set({ Authorization: 'Bearer ' + global.token })\r\n      .end((err, res) => {\r\n        Expect(res.statusCode)\r\n          .to\r\n          .equal(200);\r\n      });\r\n    done();\r\n  });\r\n\r\n  it('should not grant access to none admin users', (done) => {\r\n    chai.request(app)\r\n      .get('/api/v1/requests/')\r\n      .set({ Authorization: 'Bearer ' + global.token })\r\n      .end((err, res) => {\r\n        Expect(res.statusCode)\r\n          .to\r\n          .equal(403);\r\n      });\r\n    done();\r\n  });\r\n});\r\n"]}